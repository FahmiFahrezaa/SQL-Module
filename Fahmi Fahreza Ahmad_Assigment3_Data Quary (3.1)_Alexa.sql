select categories.categoryname, count (products.productid) as numproducts from categories join products on categories.categoryid = products.categoryid group by categories.categoryname;
select products.productname, sum(order_details.unitprice * order_details.quantity * (1 - order_details.discount)) as totalvalue from products join order_details on products.productid = order_details.productid join orders on order_details.orderid = orders.orderid where orders.orderdate between '1997-01-01' and '1997-12-31' group by products.productname;
select customers.customerid, customers.companyname, sum(order_details.unitprice * order_details.quantity) as TotalSpent from customers inner join orders on customers.customerid = orders.customerid inner join order_details on orders.orderid = order_details.orderid group by customers.customerid, customers.companyname having sum(order_details.unitprice * order_details.quantity) > 5000;
select customers.customerid, customers.companyname, sum(order_details.unitprice * order_details.quantity) as TotalSpent from customers join orders on customers.customerid = orders.customerid join order_details on orders.orderid = order_details.orderid where orders.orderdate >= '1997-01-01' and orders.orderdate < '1997-07-01' group by customers.customerid, customers.companyname having sum(order_details.unitprice * order_details.quantity) > 5000;